# Итераторы и генераторы

## Итераторы

Итераторы в Python позволяют перебирать элементы объекта по одному, не загружая весь набор данных в память. Они реализуют два основных метода: `__iter__` и `__next__`.

### Как работает `for item in x:`

Цикл `for` в Python автоматически вызывает метод `__iter__` для получения итератора объекта, а затем многократно вызывает `__next__` для получения следующего элемента, пока не будет вызвано исключение `StopIteration`.

Пример создания пользовательского итератора:

```python
class MyIterator:
    def __init__(self, n):
        self.n = n

    def __iter__(self):
        self.counter = 0
        return self

    def __next__(self):
        if self.counter >= self.n:
            raise StopIteration
        self.counter += 1
        return "Hi"

# Использование итератора
hello_iterator = MyIterator(n=10)
for item in hello_iterator:
    print(item)
```

В этом примере:
- `__init__` инициализирует итератор с заданным количеством итераций `n`.
- `__iter__` возвращает сам итератор.
- `__next__` возвращает строку `"Hi"` и увеличивает счетчик, пока не достигнет лимита, после чего вызывает `StopIteration`.

## Генераторы

Генератор — это функция, которая возвращает итератор, используя ключевое слово `yield`. Генераторы упрощают создание итераторов, позволяя "замораживать" выполнение функции и возвращать значения по одному.

Пример создания генератора:

```python
def hello_world():
    while True:
        yield "Hello world!"

# Использование генератора
hello_gen = hello_world()
for item in hello_gen:
    print(item)
    break  # Добавлен break, чтобы избежать бесконечного цикла
```

В этом примере:
- Функция `hello_world` использует `yield` для возврата строки `"Hello world!"`.
- Генератор продолжает возвращать значения до тех пор, пока не будет прерван (в примере добавлен `break` для демонстрации).

## Генераторные выражения (Comprehensions)

Генераторные выражения — это компактный способ создания генераторов, похожий на списковые включения, но возвращающий итератор вместо списка.

Пример генераторного выражения:

```python
data = (item**2 for item in range(10) if item % 2 == 0)

# Итерация по генератору
for i in data:
    print(i)
```

В этом примере:
- Генераторное выражение `(item**2 for item in range(10) if item % 2 == 0)` создает итератор, возвращающий квадраты четных чисел от 0 до 9.
- При итерации выводятся значения: `0, 4, 16, 36, 64`.

### Преимущества генераторов:
- Экономия памяти, так как значения генерируются по одному.
- Возможность работы с бесконечными последовательностями.
- Простота реализации по сравнению с пользовательскими итераторами.