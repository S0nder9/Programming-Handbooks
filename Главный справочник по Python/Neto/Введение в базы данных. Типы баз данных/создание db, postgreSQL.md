# Настройка PostgreSQL и основы работы с базами данных

Этот документ содержит пошаговое руководство по установке и настройке PostgreSQL, базовые команды для работы с базами данных, а также информацию о создании и управлении таблицами. В дополнение описывается использование менеджера баз данных DBeaver.

---

## Установка и настройка PostgreSQL

1. **Скачать и установить PostgreSQL:**
   - Перейдите на [официальный сайт PostgreSQL](https://www.postgresql.org/download/) и скачайте установщик для вашей операционной системы (например, Windows).
   - Во время установки выберите компоненты (обычно PostgreSQL Server и pgAdmin) и укажите пароль для пользователя `postgres` (суперпользователь).

2. **Добавить PostgreSQL в PATH (Windows):**
   - Откройте "Панель управления" → "Система и безопасность" → "Система" → "Дополнительные параметры системы".
   - В разделе "Переменные среды" найдите переменную `Path` в "Системных переменных" и добавьте путь к папке `bin` PostgreSQL, например: `C:\Program Files\PostgreSQL\17\bin`.
   - Сохраните изменения и перезапустите командную строку.

3. **Создать базу данных:**
   - Откройте командную строку (`cmd`).
   - Выполните команду:
     ```bash
     createdb -U postgres test
     ```
   - Введите пароль пользователя `postgres`, указанный при установке.

4. **Подключиться к базе данных:**
   - В командной строке выполните:
     ```bash
     psql -U postgres -d test
     ```
   - Введите пароль пользователя `postgres`.
   - После успешного подключения вы окажетесь в интерактивной оболочке `psql`.

---

## Основные команды в `psql`

- **Список всех команд:** `\?`
- **Просмотр списка баз данных:** `\l`
- **Просмотр списка таблиц:** `\dt`
- **Выход из `psql`:** `\q`

- **Удалить базу данных:**
  ```bash
  dropdb -U postgres test
  ```

---

## Основы SQL: Типы запросов

SQL делится на несколько категорий в зависимости от назначения запросов:

1. **DDL (Data Definition Language)** — для определения структуры базы данных:
   - `CREATE` — создание таблиц, баз данных и других объектов.
   - `ALTER` — изменение существующих объектов.
   - `DROP` — удаление объектов.

2. **DML (Data Manipulation Language)** — для работы с данными:
   - `SELECT` — выбор данных.
   - `INSERT` — добавление данных.
   - `UPDATE` — обновление данных.
   - `DELETE` — удаление данных.

3. **TCL (Transaction Control Language)** — для управления транзакциями:
   - `COMMIT` — подтверждение транзакции.
   - `ROLLBACK` — откат транзакции.
   - `SAVEPOINT` — установка точки сохранения.

4. **DCL (Data Control Language)** — для управления доступом:
   - `GRANT` — предоставление прав.
   - `REVOKE` — отзыв прав.
   - `DENY` — запрет доступа.

---

## Создание и управление таблицами

### Общий синтаксис создания таблицы:

```sql
CREATE TABLE table_name (
    column_name_1 data_type [constraints],
    column_name_2 data_type [constraints],
    column_name_3 data_type [constraints]
);
```

### Пример создания таблицы:

```sql
CREATE TABLE IF NOT EXISTS Student (
    id SERIAL PRIMARY KEY,
    name VARCHAR(60) NOT NULL,
    age INTEGER NOT NULL
);
```

**Пояснение:**
1. **Названия столбцов:** `id`, `name`, `age`.
2. **Типы данных:**
   - `SERIAL` — автоинкрементируемый целочисленный тип (увеличивается на 1).
   - `VARCHAR(n)` — строка с ограничением длины (например, до 60 символов).
   - `INTEGER` — целое число.
   - Другие типы: `TEXT`, `BOOLEAN`, `DATE`, `TIMESTAMP`, и т.д.
3. **Ограничения:**
   - `PRIMARY KEY` — уникальный идентификатор записи.
   - `NOT NULL` — поле не может быть пустым.
   - `UNIQUE` — значения в столбце должны быть уникальными.
4. **IF NOT EXISTS** — предотвращает ошибку, если таблица уже существует.

### Изменение таблицы:

```sql
ALTER TABLE Student RENAME COLUMN name TO first_name;
```

**Пояснение:** Переименование столбца `name` в `first_name`.

### Удаление таблицы:

```sql
DROP TABLE Student;
```

**Пояснение:** Удаляет таблицу `Student`. Для безопасного удаления можно добавить `IF EXISTS`:

```sql
DROP TABLE IF EXISTS Student;
```

---

## Менеджер баз данных DBeaver

**DBeaver** — это универсальный инструмент для управления базами данных с графическим интерфейсом, поддерживающий PostgreSQL и многие другие СУБД.

### Установка и настройка:

1. **Скачать DBeaver:**
   - Перейдите на [официальный сайт DBeaver](https://dbeaver.io/download/) и скачайте версию для вашей ОС.
   - Установите программу, следуя инструкциям.

2. **Подключение к PostgreSQL:**
   - Откройте DBeaver и выберите "New Database Connection".
   - Выберите "PostgreSQL" в списке драйверов.
   - Укажите параметры подключения:
     - **Host:** `localhost` (или IP сервера).
     - **Database:** `test` (или имя другой базы данных).
     - **Username:** `postgres`.
     - **Password:** пароль, заданный при установке PostgreSQL.
   - Нажмите "Test Connection" для проверки.
   - Сохраните подключение.

3. **Основные возможности DBeaver:**
   - **Просмотр структуры:** В дереве слева отображаются базы данных, таблицы, столбцы и связи.
   - **SQL-редактор:** Позволяет писать и выполнять SQL-запросы.
   - **Визуализация данных:** Таблицы можно просматривать в виде сетки, редактировать данные напрямую.
   - **ER-диаграммы:** Автоматическое построение схем связей между таблицами.
   - **Импорт/экспорт:** Поддержка импорта и экспорта данных в CSV, JSON и других форматах.

---

## Рекомендации по работе

1. **Безопасность:**
   - Храните пароль пользователя `postgres` в безопасном месте.
   - Для продакшн-систем создавайте отдельных пользователей с ограниченными правами:
     ```sql
     CREATE USER app_user WITH PASSWORD 'secure_password';
     GRANT CONNECT ON DATABASE test TO app_user;
     GRANT SELECT, INSERT, UPDATE, DELETE ON TABLE Student TO app_user;
     ```

2. **Резервное копирование:**
   - Регулярно создавайте резервные копии базы данных:
     ```bash
     pg_dump -U postgres test > backup.sql
     ```
   - Для восстановления:
     ```bash
     psql -U postgres -d test < backup.sql
     ```

3. **Оптимизация в DBeaver:**
   - Используйте автодополнение в SQL-редакторе для ускорения написания запросов.
   - Настройте форматирование SQL-кода в настройках DBeaver для единообразия.

4. **Изучение SQL:**
   - Для практики используйте тестовые данные:
     ```sql
     INSERT INTO Student (name, age) VALUES ('Alice', 20), ('Bob', 22);
     SELECT * FROM Student;
     ```