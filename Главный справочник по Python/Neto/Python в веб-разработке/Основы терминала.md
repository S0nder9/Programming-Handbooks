# Работа с терминалом

Этот документ описывает основы работы с терминалом, включая виды терминалов, команды, ключи, пути, перенаправление потоков, конвейеры, переменные окружения и управление пакетами в Unix-подобных системах.

---

## Что такое терминал?

**Терминал** — это программа, которая предоставляет интерфейс командной строки для выполнения команд в операционной системе. Большинство серверов управляются исключительно через терминал, так как он позволяет эффективно взаимодействовать с системой.

**Конвейер** — это механизм, позволяющий передавать вывод одной команды как вход для другой, создавая цепочку обработки данных.

---

## Виды терминалов

### Windows
1. **cmd** — стандартный командный интерпретатор Windows.
2. **PowerShell** — более мощный инструмент для Windows, поддерживающий сложные скрипты.
3. **Git Bash** — эмуляция Unix-терминала в Windows, поставляется с Git.
4. **WSL/WSL2** (Windows Subsystem for Linux) — подсистема, позволяющая запускать Linux-дистрибутивы (например, Ubuntu) внутри Windows, предоставляя доступ к Unix-командам.

### Linux
1. **bash** (Bourne Again Shell) — наиболее распространённый терминал, используемый в большинстве дистрибутивов Linux и в Docker.
2. **zsh** (Z Shell) — расширенная альтернатива bash с улучшенной автодополнением и настройками.

---

## Что такое WSL?

**WSL** (Windows Subsystem for Linux) — это подсистема Windows, которая позволяет запускать Linux-дистрибутивы (например, Ubuntu) без необходимости установки отдельной виртуальной машины. WSL2 улучшает производительность и интеграцию, обеспечивая полноценную Linux-среду.

**Пример установки WSL:**
```powershell
wsl --install
```

После установки можно использовать команды Linux, такие как `ls`, `cat`, `grep`, в Windows.

---

## Команды и ключи

**Команды** — это подпрограммы, выполняющие определённые задачи (например, `ls` для отображения файлов).

**Ключи** — это аргументы, модифицирующие поведение команды. Они начинаются с `-` (короткий формат) или `--` (полный формат).

**Структура команды:**
```
<command> [<arg1> <arg2> ...]
```

**Пример:**
```bash
ls -l --all
```
- `ls` — команда.
- `-l` и `--all` — ключи, изменяющие вывод (подробный список и показ скрытых файлов).

**Общие ключи:**
- `--help` — отображает справку по команде.
- `-r` — рекурсивное выполнение (например, удаление директории со всем содержимым).

---

### Примеры команд

1. **`ls <arg>`** — отображает список файлов и директорий.
   ```bash
   ls -l  # Подробный список
   ```
2. **`pwd`** — показывает текущую директорию.
   ```bash
   pwd
   ```
3. **`cd <path>`** — изменяет текущую директорию.
   ```bash
   cd ~/Desktop
   ```
4. **`mkdir <name>`** — создаёт директорию.
   ```bash
   mkdir -p folder1/folder2  # Создаёт вложенные директории
   ```
5. **`touch <name>`** — создаёт пустой файл.
   ```bash
   touch file.txt
   ```
6. **`top`** — показывает активные процессы.
7. **`q`** — выход из интерактивных утилит, таких как `top`.
8. **`kill <pid>`** — завершает процесс по его ID.
9. **`ping <address>`** — проверяет соединение с сервером.
   ```bash
   ping google.com
   ```
10. **`ls -l`** — подробный список файлов.
11. **`sudo chown root -R file.txt`** — изменяет владельца файла или директории рекурсивно.
12. **`rm -r folder`** — удаляет директорию со всем содержимым.
13. **`cat file_name`** — отображает содержимое файла.
    ```bash
    cat file.txt
    ```
14. **`nano file_name`** — открывает файл в текстовом редакторе nano.
15. **`cp file_name new_file_name`** — копирует файл.
    ```bash
    cp file.txt file_copy.txt
    ```
16. **`mkdir --help`** — показывает справку по команде.

---

## Пути в Unix-подобных системах

- **Абсолютный путь**: Полный путь от корня файловой системы.
  ```bash
  /home/username/file.txt
  ```
- **Относительный путь**: Путь относительно текущей директории.
  ```bash
  ./folder/file.txt
  ```
- **Символы**:
  - `~` — домашняя директория пользователя (`/home/username`).
  - `..` — родительская директория.
  - `.` — текущая директория.

**Пример:**
```bash
cd ~/Desktop  # Переход в папку Desktop в домашней директории
```

---

## Перенаправление потоков и конвейеры

### Перенаправление потоков
Перенаправление позволяет отправить вывод команды в файл или использовать файл как входные данные.

1. **`>`** — перенаправляет вывод в файл (перезаписывает).
   ```bash
   ls -l > list.txt  # Сохраняет вывод ls в list.txt
   ```
2. **`<`** — использует файл как входные данные.
   ```bash
   cat < file1.txt  # Отображает содержимое file1.txt
   ```
3. **`< >`** — копирует содержимое одного файла в другой.
   ```bash
   cat < file1.txt > file2.txt
   ```

### Конвейеры
Конвейер (`|`) передаёт вывод одной команды как вход для другой.

**Пример:**
```bash
ls -l | grep .pdf  # Показывает только файлы с расширением .pdf
```

**Пример обработки данных:**
```bash
# Исходный файл menu.txt: Борщ Котлеты Борщ Рассольник Котлеты Пюре
cat menu.txt | sort | uniq -c | sort -r
```

**Результат:**
```
2 Котлеты
2 Борщ
1 Рассольник
1 Пюре
```

**Пояснение:**
- `sort` — сортирует строки.
- `uniq -c` — подсчитывает уникальные строки.
- `sort -r` — сортирует в обратном порядке.

---

## Переменные окружения

**Переменные окружения** — это переменные, хранящиеся в операционной системе, которые используются программами для настройки поведения.

**Просмотр всех переменных:**
```bash
env
```

**Создание переменной:**
```bash
export DB_USER="admin"
```

**Удаление переменной:**
```bash
unset DB_USER
```

**Пример использования в Python:**
```python
import os

user = os.getenv("DB_USER")
name = os.getenv("DB_NAME")
password = os.getenv("DB_PASSWORD")

DSN = f"postgresql://{user}:{password}@localhost:5432/{name}"
print(DSN)
```

**Пояснение:**
- `os.getenv` получает значение переменной окружения.
- Для постоянного хранения переменных добавьте их в `~/.bashrc` или `~/.zshrc`:
  ```bash
  echo 'export DB_USER="admin"' >> ~/.bashrc
  source ~/.bashrc
  ```

---

## Управление пакетами

### Ubuntu
- **apt**: Основной менеджер пакетов.
  ```bash
  sudo apt update
  sudo apt install package_name
  ```
- **snap**: Альтернативный менеджер для установки приложений.
  ```bash
  snap install package_name
  ```

### macOS
- **Homebrew**: Популярный менеджер пакетов.
  ```bash
  brew install package_name
  ```

**Пример:**
```bash
sudo apt install python3
brew install python3
```

---

## Рекомендации по работе с терминалом

1. **Изучение команд:**
   - Используйте `--help` или `man <command>` для получения справки:
     ```bash
     man ls
     ```
2. **Автодополнение:**
   - В `bash` и `zsh` используйте клавишу `Tab` для автодополнения команд и путей.
3. **Сохранение команд:**
   - Сохраняйте часто используемые команды в скрипты:
     ```bash
     echo 'ls -l | grep .pdf' > myscript.sh
     chmod +x myscript.sh
     ./myscript.sh
     ```
4. **Безопасность:**
   - Будьте осторожны с `sudo` и командами вроде `rm -r`.
   - Проверяйте команды перед выполнением.
5. **WSL:**
   - Используйте WSL2 для лучшей производительности и интеграции с Windows.
   - Установите дистрибутив, например:
     ```powershell
     wsl --install -d Ubuntu
     ```
6. **Переменные окружения:**
   - Храните чувствительные данные (пароли, ключи API) в переменных окружения, а не в коде.
   - Используйте `.env` файлы с библиотекой `python-dotenv`:
     ```powershell
     pip install python-dotenv
     ```
     ```python
     from dotenv import load_dotenv
     import os
     load_dotenv()
     DB_USER = os.getenv("DB_USER")
     ```

---

## Полезные ресурсы
- [Официальная документация Bash](https://www.gnu.org/software/bash/manual/)
- [WSL Documentation](https://docs.microsoft.com/en-us/windows/wsl/)
- [Homebrew](https://brew.sh/)