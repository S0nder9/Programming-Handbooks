// Глава 14: NPM - Пересоздание каталога node_modules в Node.js

// Каталог node_modules содержит все зависимости вашего проекта, установленные через NPM.
// Иногда требуется пересоздать каталог node_modules, например, когда возникают проблемы с зависимостями,
// или когда вы хотите убедиться, что все пакеты установлены заново с их последними версиями.

// Как пересоздать каталог node_modules:
// 1. Удалите существующий каталог node_modules.
// 2. Очистите кэш NPM (опционально, но рекомендуется).
// 3. Установите зависимости заново.

// Шаг 1: Удаление каталога node_modules
// Это можно сделать вручную или с помощью команды npm.
const fs = require('fs');
const path = require('path');

const nodeModulesPath = path.join(__dirname, 'node_modules');

// Удаление каталога node_modules
fs.rm(nodeModulesPath, { recursive: true, force: true }, (err) => {
  if (err) {
    console.error('Ошибка при удалении node_modules:', err);
    return;
  }
  console.log('Каталог node_modules успешно удален.');
});

// Шаг 2: Очистка кэша NPM (опционально)
const exec = require('child_process').exec;

// Очистка кэша NPM
exec('npm cache clean --force', (error, stdout, stderr) => {
  if (error) {
    console.error('Ошибка при очистке кэша NPM:', error);
    return;
  }
  console.log('Кэш NPM успешно очищен.');
});

// Шаг 3: Установка зависимостей заново
exec('npm install', (error, stdout, stderr) => {
  if (error) {
    console.error('Ошибка при установке зависимостей:', error);
    return;
  }
  console.log('Зависимости успешно установлены.');
});

// Итог:
// Пересоздание каталога node_modules может помочь решить проблемы с зависимостями и обновить пакеты до последних версий.
// Следуйте этим шагам, чтобы убедиться, что все работает корректно и ваше окружение свежо.
